(()=>{const e=io("/");var n,t=[],r=[];function o(e,n=""){if(console.log(e),e.length&&e.length>0){var t=document.querySelector(`.player${n} .card-list.player__card`),r=e.map((function(e){return`\n            <li class="card-list__item">\n            <img src="/assets/img/${e}.png" alt="" class="card-list__item-img">\n            </li>\n            `}));r.join(" "),t.innerHTML=r}}function a(){var e=document.querySelector(".player");e.classList.contains("player--turn")&&e.classList.remove("player--turn"),e.classList.add("player--end-turn")}function c(){document.querySelector(".hit-btn").disabled=!0,document.querySelector(".done-btn").disabled=!0}function l(e){e.forEach((function(e){var n=+e.id,o=document.querySelector(`#player-${n}`);if(r.push(n),t.push(n),o)switch(r.push(+n),o.classList.remove("player--end-turn"),e.res){case-1:o.classList.add("player--lose");break;case 0:o.classList.add("player--draw");break;case 1:o.classList.add("player--win")}}))}document.querySelector(".player-area .player__name").textContent=localStorage.getItem("name"),e.on("error",(function(e){console.log(e)})),e.emit("join-room",roomId,dealerId),e.on("room-info",(function(n){!function(n){console.log(n),players=n.players;var o=players.map((function(e){var n="",t="";return e.bet>0&&(n="player--betted"),e.card>0&&(t="/assets/img/0.png"),`\n            <li class="player-item grid__col--2 ${n}"  id="player-${e.id}">\n                <span class="player-item__name">${e.name}</span>\n                <img src="${t}" alt="" class="player-item__img">\n                <div class="player-item__info">\n                <div>\n                    <span>Bài: </span>\n                    <span class="player-item__card-number">${e.card}</span>\n                </div>\n                <div>\n                    <span>Cược: </span>\n                    <span class="player-item__bet">${e.bet}</span>\n                </div>\n\n                </div>\n\n                <div class="confirm-form">\n                <div class="confirm-form__info">\n                    <span>Xác nhận xem bài</span>\n                    <span class="confirm-form__name">${e.name}</span>\n\n                </div>\n                    <div class="confirm-form__btn">\n                    <button class="confirm-form__btn--accept btn control-btn">Đồng ý</button>\n                    <button class="confirm-form__btn--reject btn control-btn">Hủy</button>\n                    </div>\n                </div>\n\n            </li>\n          \n            `}));console.log(o),document.querySelector("ul.player-list").innerHTML=o.join(" "),players.forEach((function(n){var o=document.querySelector(`#player-${n.id}`);o&&o.addEventListener("click",(function(){!function(n){if(console.log(t,n),1==t.includes(n)){var o=document.querySelector(`#player-${n}`),a=Number(o.querySelector(".player-item__card-number").textContent);if(console.log("player item",o,a),a>0){var c=o.querySelector(".player-item__name").textContent;if(-1==r.indexOf(n)){var l=o.querySelector(".confirm-form"),d=o.querySelector(".confirm-form__btn--accept"),i=o.querySelector(".confirm-form__btn--reject");l.style.display="flex",d.addEventListener("click",(function(t){t.stopPropagation(),l.style.display="none",document.querySelector(".modal .player__name").textContent=c,e.emit("show-card",roomId,dealerId,n)})),i.addEventListener("click",(function(e){e.stopPropagation(),l.style.display="none"}))}else e.emit("request-card",roomId,n)}}}(+n.id)}))}))}(n),document.querySelector(".dealer-start__btn").disabled=!0})),e.on("room-joined",(function(){console.log("created room")})),document.querySelector(".exit__btn").addEventListener("click",(function(){console.log("exit clicked"),confirm("Bạn thật sự muốn từ bỏ cơ hội kiếm cơm ?")&&(e.emit("exit-room",roomId,dealerId),window.location.replace("https://xidzach-ltd.herokuapp.com/home"))})),e.on("player-betted",(function(e,n){var t=document.querySelector(`#player-${e}`);t&&(t.querySelector(".player-item__bet").textContent=n,t.classList.add("player--betted"))})),e.on("all-player-betted",(function(){document.querySelector(".dealer-start__btn").disabled=!1})),(n=document.querySelector(".dealer-start__btn")).addEventListener("click",(function(){var t,r;t=document.querySelectorAll(".player-item__bet"),r=!0,t.forEach((function(e){var n=Number(e.textContent);r=0==Number.isNaN(n)&&n>0})),r&&(console.log("deal clicked"),e.emit("deal-card",roomId,dealerId),n.disabled=!0)})),e.on("card-dealt",(function(){document.querySelector(".dealer-reset__btn").disabled=!1,e.emit("request-card",roomId,dealerId)})),e.on("receive-card",(function(e,n){e==dealerId?o(n):(document.querySelector(".modal").style.display="flex",o(n,".other-player__card"))})),e.on("winner-winner-chicken-dinner",(function(e){l(e)})),function(){e.on("player-turn",(function(e){var n=document.querySelector(`#player-${e}`);console.log(n),n&&(n.classList.contains("player--betted")&&n.classList.remove("player--betted"),n.classList.add("player--turn"))})),e.on("dealer-turn",(function(){var e=document.querySelector(".player");e.classList.contains("player--betted")&&e.classList.remove("player--betted"),e.classList.add("player--turn"),function(){const e=document.querySelector(".hit-btn"),n=document.querySelector(".done-btn");e.disabled=!1,n.disabled=!1}()})),e.on("card-hit",(function(e){o(e)})),e.on("turn-ended",(function(){a(),c()})),e.on("player-card-change",(function(e,n){document.querySelector(`#player-${e}`).querySelector(".player-item__card-number").textContent=n})),e.on("player-finish",(function(e){var n=document.querySelector(`#player-${e}`);n&&(n.classList.contains("player--turn")&&n.classList.remove("player--turn"),n.classList.add("player--end-turn"),console.log("turn",n),t.push(+e))}));const n=document.querySelector(".hit-btn"),r=document.querySelector(".done-btn");n.addEventListener("click",(function(){e.emit("hit-card",roomId,dealerId),console.log("hit clicked")})),r.addEventListener("click",(function(){console.log("done clicked"),a(),c(),e.emit("show-all",roomId,dealerId)}))}(),e.on("show-card-result",(function(e,n,t){document.querySelector(".modal").style.display="flex",o(n,".other-player__card");var a=document.querySelector(`#player-${e}`);if(a)switch(r.push(+e),a.classList.remove("player--end-turn"),t){case-1:a.classList.add("player--lose");break;case 0:a.classList.add("player--draw");break;case 1:a.classList.add("player--win")}})),e.on("show-card-all",(function(e){console.log(e),l(e)})),document.querySelector(".close-player-btn").addEventListener("click",(function(){document.querySelector(".modal").style.display="none"})),document.querySelector(".dealer-reset__btn").addEventListener("click",(function(){e.emit("reset-game",roomId,dealerId)})),e.on("game-reset",(function(){document.querySelector(".player").className="grid__col--6 player",document.querySelector(".player .card-list.player__card").innerHTML="",c(),document.querySelector(".dealer-reset__btn").disabled=!0,document.querySelector(".dealer-start__btn").disabled=!0,r=[],t=[]}))})();